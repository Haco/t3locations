
<f:layout name="Default" />

<f:section name="main">

  <f:flashMessages renderMode="div" />

  <f:form actionUri="{f:uri.page(pageUid : pid)}">
    <f:form.select name="territory" options="{territories}" optionLabelField="title" prependOptionLabel="Choose a territory" prependOptionValue="" value="{territory}" additionalAttributes="{onchange : 'this.form.submit()'}" />
    <f:if condition="{regions -> f:count()}">
      <f:then><f:form.select name="region" options="{regions}" optionLabelField="title" prependOptionLabel="Choose a country" prependOptionValue="0" value="{region}" additionalAttributes="{onchange : 'this.form.submit()'}" /></f:then>
      <f:else><f:form.select name="region" options="{0 : 'Choose a country'}" /></f:else>
    </f:if>
  </f:form>

  <f:if condition="{locations}">
    <f:for each="{locations}" as="location">
      <div class="row t3locations">
        <div class="col-md-12 t3locations-vcard">
          <address class="vcard"><f:render partial="Location/Properties" arguments="{location : location}" /></address>
        </div>
      </div>
    </f:for>
    <div id="t3locations-map-canvas"></div>
    <script type="text/javascript" src="{f:uri.resource(path:'JavaScripts/gmaps.js')}"></script>
  </f:if>

</f:section>